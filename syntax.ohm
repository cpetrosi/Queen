QUEEN {
    Program = (FunDecl)+
    FunDecl = "ğŸ‘‘" Type id ("(" Binding+ ")")? "ğŸš€" Body
    Binding = (id ":" Type)
    Body = Exp
         | Let
         | Funcall
    Exp = "ğŸ–¨" (stringlit | id)       --print
        | Binexp                      --binexp
        | Append                      --append
        | Conditional                 --conditional
        | Match                       --match
        | Let                         --let
        | "(" Exp ")"                 --parens
        | id                          --id
        | boollit                     --bool
        | stringlit                   --string
        | numlit                      --numlit
    Pattern = Cons                    --cons
            | "ğŸ•³"                    --wild
            | "[" patternElements (";" patternElements)* "]"      --pattern
    Cons = "[]"                         --nil
         | listElement "âš¡ï¸" "[]"                 --short
         | listElement ("âš¡ï¸" Cons)*              --long
    Funcall = id "(" (id ",")+ ")"
    patternElements = numlit | id
    List = "[" listElement ("," listElement)* "]"
    listElement = numlit | stringlit | id
    Match = "match" id "with" MatchExp+
    MatchExp = "ğŸ­" Pattern "->" Exp
    Let = "let" id "ğŸš€" Exp ("in" Let)?   --let
        | Exp                             --exp
    Append = List "@" List
    Binexp = Exp1 addop Binexp            --add
           | Exp1                         --exp
    Exp1 = Exp2 mulop Exp1                --mult
         | Exp2                           --exp
    Exp2 = "-"? Exp3
    Exp3 = (numlit| id)("!")?
    Conditional = "ğŸ¤”" Exp (logical Exp)* "then" Exp ("elseğŸ¤”" Exp (logical Exp)* "then" Exp)* ("else" Exp)?
    logical = "ğŸ‘" | "ğŸ–•"
    Type = Type "list"              --list
         | Type "*" Type            --tuple
         | "bool"                   --bool
         | "int"                    --int
         | "float"                  --float
         | "string"                 --string
    boollit = "true" | "false"
    id = ~keyword letter idrest*
    idrest = letter               --ltr
           | digit                --dgt
           | "_"                  --underscore
           | "$"                  --dollar
    keyword = ("ğŸ‘‘" | "ğŸš€" | "ğŸ–¨" | "âš¡ï¸" | "ğŸ•³" | "match" | "with" | "ğŸ­" | "->" | "let" | "in"
            | "ğŸ¤”" | "elseğŸ¤”" | "then" | "else" | "true" | "false"| "ğŸ‘" | "ğŸ–•") ~idrest
    char =  escape
         |  ~"\\" ~"\"" ~"\'" ~"\\n" any
    escape =  "\\\\" | "\\\"" | "\\'" | "\\n" | "\\t"
           |  "\\u{" hexDigit+ "}"     --codepoint
    charlit =  "'" (char | "\"") "'"
    stringlit =  "\"" (char | "\'")* "\""
    numlit = digit+ ("."digit+)? ("^"digit+)?
    addop = "+"                        --add
          | "-"                        --sub
    mulop = "*"                        --mult
          | "/"                        --div
    comment = "//" (~"\n" any)* "\n"
}
