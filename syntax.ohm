QUEEN {
    Program = (FunDecl)+
    FunDecl = "ğŸ‘‘" Type id ("(" Binding+ ")")? "ğŸš€" Body
    Binding = (id ":" Type)
    Body = Exp
         | Let
         | Funcall
    Exp = "ğŸ–¨" (stringlit | id)       --print
        | Binexp                      --binexp
        | Append                      --append
        | Conditional                 --conditional
        | Match                       --match
        | Let                         --let
        | "(" Exp ")"                 --parens
        | id                          --id
        | boollit                     --bool
        | stringlit                   --string
        | numlit                      --numlit
        | "ğŸ½"                        --none
        | "ğŸ" Exp                    --some
    Pattern = Cons                    --cons
            | "ğŸ•³"                    --wild
            | "[" patternElements ("," patternElements)* "]"      --pattern
    Cons = "[]"                         --nil
         | Exp "âš¡ï¸" "[]"                 --short
         | Exp ("âš¡ï¸" Cons)*              --long
    Funcall = id "(" (id ",")+ ")"
    patternElements = numlit | id
    List = "[" Exp ("," Exp)* "]"
    Match = "match" id "with" MatchExp+
    MatchExp = "ğŸ­" Pattern "->" Exp
    Let = "let" id "ğŸš€" Exp ("in" Let)?   --let
        | Exp                             --exp
    Append = List "@" List
    Binexp = Binexp addop Exp1            --add
           | Binexp relop Exp1            --rel
           | Exp1                         --exp
    Exp1 = Exp1 mulop Exp2                --mult
         | Exp2                           --exp
    Exp2 = "-"? Exp3
    Exp3 = (numlit| id)("!")?
    Conditional = "ğŸ¤”" Exp (logical Exp)* "then" Exp ("elseğŸ¤”" Exp (logical Exp)* "then" Exp)* ("else" Exp)?
    logical = "ğŸ‘" | "ğŸ–•"
    Type = Type "list"              --list
         | Type "*" Type            --tuple
         | "bool"                   --bool
         | "int"                    --int
         | "float"                  --float
         | "string"                 --string
         | Type "option"            --option
    boollit = "true" | "false"
    id = ~keyword letter idrest*
    idrest = letter               --ltr
           | digit                --dgt
           | "_"                  --underscore
           | "$"                  --dollar
    keyword = ("ğŸ‘‘" | "ğŸš€" | "ğŸ–¨" | "âš¡ï¸" | "ğŸ•³" | "match" | "with" | "ğŸ­" | "->" | "let" | "in"
            | "ğŸ¤”" | "elseğŸ¤”" | "then" | "else" | "true" | "false"| "ğŸ‘" | "ğŸ–•" | "ğŸ’©") ~idrest
    char =  escape
         |  ~"\\" ~"\"" ~"\'" ~"\\n" any
    escape =  "\\\\" | "\\\"" | "\\'" | "\\n" | "\\t"
           |  "\\u{" hexDigit+ "}"     --codepoint
    charlit =  "'" (char | "\"") "'"
    stringlit =  "\"" (char | "\'")* "\""
    numlit = digit+ ("."digit+)? ("^"digit+)?
    addop = "+"                        --add
          | "-"                        --sub
    mulop = "*"                        --mult
          | "/"                        --div
    relop = "<"
          | ">"
          | "<="
          | ">="
          | "=="
    comment = "ğŸ’©"(~"ğŸ’©"any)*"ğŸ’©"
}
